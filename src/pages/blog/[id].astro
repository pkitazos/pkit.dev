---
import Prose from "@/components/Prose.astro";
import Layout from "@/layouts/RootLayout.astro";
import { getCollection, render } from "astro:content";
import type { CollectionEntry } from "astro:content";

export const getStaticPaths = async () => {
    const posts = await getCollection("blog");
    return posts
        .filter(
            (x: CollectionEntry<"blog">) =>
                import.meta.env.DEV || !x.data.draft,
        )
        .map((post: CollectionEntry<"blog">) => ({
            params: { id: post.id },
            props: { post },
        }));
};

const { post } = Astro.props;
const { Content } = await render(post);
---

<Layout title={post.data.title}>
    <header class="mb-8">
        <h1 class="text-3xl font-bold mb-4 text-foreground font-mono mt-10">
            {post.data.title}
        </h1>
    </header>
    <Prose>
        <Content />
    </Prose>
</Layout>
